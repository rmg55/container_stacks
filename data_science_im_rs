FROM rowangaffney/data_science_im_rs_step1

USER $NB_UID

LABEL maintainer="Rowan Gaffney <rowan.gaffney@ars.usda.gov>"

# R packages
RUN conda update -n base conda --yes
RUN conda create -n R_geo --yes
RUN conda install -n R_geo -c r r-irkernel rstudio

RUN conda install -n R_geo -c conda-forge --quiet --yes \
  'r-rgdal' \
  'r-gdalutils' \
  'r-raster' \
  'r-snow' \
  'r-sf' \
  'r-gstat' \
  'r-maptools' \
  'r-rgeos' \
  'r-irkernel' \
  'r-sp'

RUN conda install -c conda-forge jupyter-rsession-proxy
RUN jupyter labextension install @oriolmirosa/jupyterlab_materialdarker

#RUN conda config --add channels "conda-forge/label/cf201901"
#RUN conda install -n R_geo -c "conda-forge/label/cf201901" r-rgdal r-gdalutils

RUN fix-permissions /home/$NB_USER
RUN fix-permissions $CONDA_DIR

RUN conda init

#RUN conda activate R_geo
#RUN Rscript -e "install.packages('neonUtilities',repos = 'http://cran.us.r-project.org')"
